<?php/** * * * Zenbership Membership Software * Copyright (C) 2013-2016 Castlamp, LLC * * This program is free software: you can redistribute it and/or modify * it under the terms of the GNU General Public License as published by * the Free Software Foundation, either version 3 of the License, or * (at your option) any later version. * * This program is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the * GNU General Public License for more details. * * You should have received a copy of the GNU General Public License * along with this program.  If not, see <http://www.gnu.org/licenses/>. * * @author      Castlamp * @link        http://www.castlamp.com/ * @link        http://www.zenbership.com/ * @copyright   (c) 2013-2016 Castlamp * @license     http://www.gnu.org/licenses/gpl-3.0.en.html * @project     Zenbership Membership Software */$af = new adminFields();$user = new user;$data = $user->get_user($_POST['id']);$field = new field;$final_form_col1 = $field->generate_form('member-edit', $data['data'], '1');$final_form_col2 = $field->generate_form('member-edit', $data['data'], '2');$q1 = $db->run_query("  SELECT      ppSD_fieldsets.id,      ppSD_fieldsets.name  FROM      `ppSD_fieldsets_locations`  JOIN      `ppSD_fieldsets`  ON      ppSD_fieldsets.id=ppSD_fieldsets_locations.fieldset_id  WHERE      ppSD_fieldsets_locations.location='member-edit'  ORDER BY      ppSD_fieldsets.name ASC");$list = '<ul id="fieldset_list">';$list .= '<li class="on" id="li-fs9999" onclick="return show_fieldset(\'9999\');">Member Overview</li>';while ($row = $q1->fetch()) {    $list .= '<li id="li-fs' . $row['id'] . '" onclick="return show_fieldset(\'' . $row['id'] . '\');">' . $row['name'] . '</li>';}$list .= '<li id="show_all" onclick="return show_fieldset(\'show_all\');">Show All</li>';$list .= '</ul>';$field = new field();$final_form_col3 = '';$q2 = $db->run_query("    SELECT        `id`,        `form_id`,        `user_id`,        `form_name`    FROM        `ppSD_form_submit`    WHERE        `user_id`='" . $db->mysql_clean($data['data']['id']) . "'    ORDER BY        `form_name` ASC");$listA = '<ul id="fieldset_list">';while ($row = $q2->fetch()) {    $listA .= '<li id="li-fs' . $row['id'] . '" onclick="return show_fieldset(\'' . $row['id'] . '\');">' . $row['form_name'] . '</li>';    $dataA = $db->assemble_eav_data($row['id']);    $final_form_col3 .= $db->format_eav_data($dataA, $row['id'], $row['form_name'], '1');}if (empty($final_form_col3)) {    $listA .= '<li class="weak">No additional data to display.</li>';}$listA .= '</ul>';?><script type="text/javascript">    $.ctrl('S', function () {        return json_add('member-add', '<?php echo $data['data']['id']; ?>', '1', 'slider_formA');    });</script><form action="null.php" method="post" id="slider_formA"      onsubmit="return json_add('member-add','<?php echo $data['data']['id']; ?>','1','slider_formA');"><div id="slide_home_left" class="col25l padLeft padTop">    <?php    echo $list;    echo $listA;    ?></div><div id="slide_home_right" class="col75r  padRight padTop"><div id="primary_fields"><div class="marginbot right">    <input type="submit" value="Save" class="save"/></div><fieldset id="fs9999">    <legend>Member Details</legend>    <div class="pad24t">        <label>Username</label>        <?php        echo $af->string('username', $data['data']['username'], 'req');        ?>        <label>Member Type</label>        <?php        $types = $admin->member_types('', 'array');        echo $af            ->setDescription('What member type should this member be assigned to?')            ->select('member_type', $data['data']['member_type'], $types);        ?>        <label>Account</label>        <?php        echo $af->accountList('account', $data['data']['account'], '');        ?>        <?php        if ($employee['permissions']['admin'] == '1') {        ?>            <label>Assign To Employee?</label>        <?php            echo $af                ->staffList('owner', $data['owner']['id'], '');        }        ?>        <label>Source</label>        <?php        $db->run_query("SELECT notreal FROM ppSD_memebrs WHERE 1");        echo $af            ->setDescription('Where was this member generated?')            ->sourceList('source', $data['data']['source'], '');        ?>        <label>E-Mail Preference</label>        <?php        echo $af->radio('email_pref', $data['data']['email_pref'], array(            '' => 'No Preference',            'html' => 'HTML',            'text' => 'Plain Text',        ));        ?>        <label>Joined</label>        <?php        echo $af->setSpecialType('date')            ->string('joined', $data['data']['joined']);        ?>        <label>Last Renewal</label>        <?php        echo $af->setSpecialType('date')            ->string('last_renewal', $data['data']['last_renewal']);        ?>        <label>Last Updated</label>        <?php        echo $af->setSpecialType('date')            ->string('last_updated', $data['data']['last_updated']);        ?>        <label>Last Login</label>        <?php        echo $af->setSpecialType('date')            ->string('last_renewal', $data['data']['last_login']);        ?>        <label>Login Redirection</label>        <?php        echo $af            ->setDescription('If you input a URL in this field, this member will be redirected to that location when he/she logs in.')            ->setPlaceholder('http://www.somewhere.com/start_page_for_this_user.html')            ->string('last_renewal', $data['data']['start_page']);        ?>    </div></fieldset><?phpecho $final_form_col1;echo $final_form_col2;echo $final_form_col3;?></div></div><div class="clear"></div></form><script type="text/javascript" src="js/fs_rotator.js"></script>