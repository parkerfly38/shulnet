<?php/** * * * Zenbership Membership Software * Copyright (C) 2013-2016 Castlamp, LLC * * This program is free software: you can redistribute it and/or modify * it under the terms of the GNU General Public License as published by * the Free Software Foundation, either version 3 of the License, or * (at your option) any later version. * * This program is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the * GNU General Public License for more details. * * You should have received a copy of the GNU General Public License * along with this program.  If not, see <http://www.gnu.org/licenses/>. * * @author      Castlamp * @link        http://www.castlamp.com/ * @link        http://www.zenbership.com/ * @copyright   (c) 2013-2016 Castlamp * @license     http://www.gnu.org/licenses/gpl-3.0.en.html * @project     Zenbership Membership Software */$type = 'folder';if (!empty($_POST['id'])) {    $content = new content;    $data    = $content->get_content($_POST['id']);    if ($data['error'] == '1') {        $admin->show_popup_error($data['error_details']);        exit;    } else {        $cid     = $_POST['id'];        $editing = '1';    }} else {    $temp_data = '';    $data      = array(        'name'            => '',        'menus'           => array(),        'fieldsets'       => array(),        'url'             => PP_URL,        'path'            => PP_BASE_PATH,        'permalink'       => '',        'permalink_clean' => '',        'full_link'       => PP_URL,    );    $cid       = 'new';    $editing   = '0';}?><script type="text/javascript">    $.ctrl('S', function () {        return json_add('content-folder-add', '<?php echo $cid; ?>', '<?php echo $editing; ?>', 'popupform');    });</script><form action="" method="post" id="popupform"      onsubmit="return json_add('content-folder-add','<?php echo $cid; ?>','<?php echo $editing; ?>','popupform');">    <div id="popupsave">        <?php        if (! empty($_POST['id'])) {            ?>            <input type="submit" value="Grant Access From Criteria" onclick="return switch_popup('build_criteria','type=member&act=content_access&act_id=<?php echo $cid; ?>','');" />        <?php        }        ?>        <input type="submit" value="Save" class="save" />        <input type="hidden" name="type" value="<?php echo $type; ?>" />    </div>    <h1>Folder Security Management</h1>    <div class="pad24t popupbody">        <fieldset>            <legend>Basic Details</legend>            <div class="pad24t">                <div class="field">                    <label>Name</label>                    <div class="field_entry">                        <input type="text" name="name" class="req" id="name" style="width:300px;"                               value="<?php echo $data['name']; ?>"/>                    </div>                </div>                <div class="field">                    <label>Path</label>                    <div class="field_entry">                        <input type="text" name="path" onkeyup="return check_folder();" class="req" id="path"                               style="width:100%;" value="<?php echo $data['path']; ?>"/>                        <p id="preview_path"></p>                    </div>                </div>                <div class="field">                    <label>URL</label>                    <div class="field_entry">                        <input type="text" name="url" class="req" id="url" style="width:100%;"                               value="<?php echo $data['url']; ?>"/>                        <p id="field_description">The URL to which users will be redirected when they click on this                            content from the member management page.<br/>Format:                            http://www.yoursite.com/path/to/folder/page.php</p>                    </div>                </div>            </div>        </fieldset>        <fieldset>            <legend>Fieldsets</legend>            <div class="pad24t">                <p>Select any fieldset from the following list to add it to the user's "Update Account" page.                    Essentially this means that any users with access to this secure folder will be able to update these                    fields when updating their account.</p>                <div class="field">                    <?php                    echo $admin->get_fieldsets($data['fieldsets']);                    ?>                </div>            </div>        </fieldset>        <fieldset>            <legend>Menus</legend>            <div class="pad24t">                <div class="field">                    <?php                    echo $admin->get_menus($data['menus']);                    ?>                </div>            </div>        </fieldset>    </div></form><script type="text/javascript">    function check_folder() {        send_data = 'path=' + $('#path').val();        $.post('cp-functions/check_folder.php', send_data, function (theResponse) {            $('#preview_path').html(theResponse);        });        return false;    }</script>