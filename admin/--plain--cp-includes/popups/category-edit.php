<?php/** * * * Zenbership Membership Software * Copyright (C) 2013-2016 Castlamp, LLC * * This program is free software: you can redistribute it and/or modify * it under the terms of the GNU General Public License as published by * the Free Software Foundation, either version 3 of the License, or * (at your option) any later version. * * This program is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the * GNU General Public License for more details. * * You should have received a copy of the GNU General Public License * along with this program.  If not, see <http://www.gnu.org/licenses/>. * * @author      Castlamp * @link        http://www.castlamp.com/ * @link        http://www.zenbership.com/ * @copyright   (c) 2013-2016 Castlamp * @license     http://www.gnu.org/licenses/gpl-3.0.en.html * @project     Zenbership Membership Software */if (!empty($_POST['id'])) {    $data         = new history($_POST['id'], '', '', '', '', '', 'ppSD_cart_categories');    $editing      = '1';    $cid          = $_POST['id'];    $hide         = $data->final_content['hide'];    $members_only = $data->final_content['members_only'];} else {    $date         = current_date();    $deadline     = '';    $editing      = '0';    $hide         = '0';    $members_only = '0';    $cid          = 'x'; // auto_increment}?><script src="js/form_rotator.js" type="text/javascript"></script><script type="text/javascript">    $.ctrl('S', function () {        return json_add('category-add', '<?php echo $cid; ?>', '<?php echo $editing; ?>', 'popupform');    });</script><form action="" method="post" id="popupform"      onsubmit="return json_add('category-add','<?php echo $cid; ?>','<?php echo $editing; ?>','popupform');">    <div id="popupsave">        <input type="submit" value="Save" class="save"/>        <input type="hidden" name="id" value="<?php echo $cid; ?>"/>    </div>    <h1>Cart Category</h1>    <ul id="theStepList">        <li class="on" onclick="return goToStep('0');">Overview</li>        <?php        if ($editing == '1') {        ?>        <li onclick="return goToStep('1');">Order Products</li>        <?php        }        ?>    </ul>        <div class="pad24t popupbody">        <ul id="formlist">        <li class="form_step">            <fieldset>                <legend>Basics</legend>                <div class="pad24t">                    <div class="field">                        <label class="less">Status</label>                        <div class="field_entry_less">                            <input type="radio" name="hide" value="0"<?php if ($hide != '1') {                                echo " checked=\"checked\"";                            } ?> /> Visible<br/><input type="radio" name="hide" value="1"<?php if ($hide == '1') {                                echo " checked=\"checked\"";                            } ?> /> Hidden                        </div>                    </div>                    <div class="field">                        <label class="less">Access</label>                        <div class="field_entry_less">                            <input type="radio" name="members_only" value="1" <?php if ($members_only == '1') {                                echo " checked=\"checked\"";                            } ?> /> Membership Required<br/>                            <input type="radio" name="members_only" value="0" <?php if ($members_only != '1') {                                echo " checked=\"checked\"";                            } ?> /> No Membership Required                        </div>                    </div>                    <div class="field">                        <label class="less">Found In</label>                        <div class="field_entry_less">                            <select name="subcategory" id="subcategory" style="width:250px;" class="req">                                <?php                                if (!empty($data->{'final_content'}['subcategory'])) {                                    $subcat = $data->{'final_content'}['subcategory'];                                } else {                                    $subcat = '1';                                }                                echo $admin->cart_category_select($subcat);                                ?>                            </select>                        </div>                    </div>                    <div class="field">                        <label class="less">Title</label>                        <div class="field_entry_less">                            <input type="text" name="name" id="name"                                   value="<?php if (!empty($data->{'final_content'}['name'])) {                                       echo $data->{'final_content'}['name'];                                   } ?>" style="width:100%;" maxlength="85" class="req"/>                        </div>                    </div>                    <div class="field">                        <label class="top">Description</label>                        <div class="clear"></div>                        <div class="field_entry_top">                            <textarea name="description" class="richtext" id="f21"                                      style="width:100%;height:200px;"><?php if (!empty($data->{'final_content'}['description'])) {                                    echo $data->{'final_content'}['description'];                                } ?></textarea>                        </div>                        <?php                        echo $admin->richtext('100%', '200px','f21','0','1');                        ?>                    </div>                </div>            </fieldset>            <fieldset>                <legend>Meta Data</legend>                <div class="pad24t">                    <div class="field">                        <label class="less">Indexing</label>                        <div class="field_entry_less">                            <input type="checkbox" name="search_index" value="1" checked="<?php                            if ($editing == '1') {                                if ($data->{'final_content'}['search_index'] == '1') {                                    $checked = '1';                                } else {                                    $checked = '0';                                }                            } else {                                $checked = 'checked';                            }                            echo $checked;                            ?>"/> Allow search engines to index this category.                        </div>                    </div>                    <div class="field">                        <label class="less">Title</label>                        <div class="field_entry_less">                            <input type="text" name="meta_title"                                   value="<?php if (!empty($data->{'final_content'}['meta_title'])) {                                       echo $data->{'final_content'}['meta_title'];                                   } ?>" style="width:100%;" maxlength="66"/>                        </div>                    </div>                    <div class="field">                        <label class="less">Description</label>                        <div class="field_entry_less">                            <input type="text" name="meta_desc"                                   value="<?php if (!empty($data->{'final_content'}['meta_desc'])) {                                       echo $data->{'final_content'}['meta_desc'];                                   } ?>" style="width:100%;" maxlength="175"/>                        </div>                    </div>                    <div class="field">                        <label class="less">Keywords</label>                        <div class="field_entry_less">                            <input type="text" name="meta_keywords"                                   value="<?php if (!empty($data->{'final_content'}['meta_keywords'])) {                                       echo $data->{'final_content'}['meta_keywords'];                                   } ?>" style="width:100%;" maxlength="175"/>                        </div>                    </div>                </div>            </fieldset>            <fieldset>                <legend>Design</legend>                <div class="pad24t">                    <div class="field">                        <label class="less">Columns</label>                        <div class="field_entry_less">                            Display <input type="text" name="cols" style="width:80px;" maxlength="1"                                           value="<?php if (!empty($data->{'final_content'}['cols'])) {                                               echo $data->{'final_content'}['cols'];                                           } else {                                               echo "1";                                           } ?>"/> products per row.                        </div>                    </div>                </div>            </fieldset>        </li>            <?php            if ($editing == '1') {            ?>                <li class="form_step">            <link type="text/css" rel="stylesheet" media="all" href="css/fields_sortable.css"/>            <script type="text/javascript">                $(document).ready(function () {                    $("#prod_list").sortable({                        placeholder: "ui-state-highlight"                    }).disableSelection();                });            </script>            <ul id="prod_list" class="colfields ui-sortable">                <?php                $prods = $db->run_query("                    SELECT                        `id`,`name`                    FROM                        `ppSD_products`                    WHERE                        `category`='" . $db->mysql_clean($_POST['id']) . "'                    ORDER BY                        `cart_ordering` ASC                ");                while ($row = $prods->fetch()) {                    echo "<li><input type=\"hidden\" name=\"reorder[" . $row['id'] . "]\" value=\"1\" />" . $row['name'] . "<div class=\"move\"></div></li>";                }                ?>            </ul>        </li>            <?php            }            ?>        </ul>    </div></form>